@if (ViewBag.role == "Qualité")
{
    ViewBag.Title = "AllCases";

    Layout = "~/Views/Shared/_Layout_Qualite.cshtml";
}
@if (ViewBag.role == "Agent Qualité")
{
    ViewBag.Title = "AllCases";

    Layout = "~/Views/Shared/_Layout_AgentQualite.cshtml";
}
@if (ViewBag.role == "Agent Qualité_CustomerService")
{
    ViewBag.Title = "AllCases";

    Layout = "~/Views/Shared/_Layout_CustomerService.cshtml";
}
@if (ViewBag.role == "Agent Qualité_HL")
{
    ViewBag.Title = "AllCases";

    Layout = "~/Views/Shared/_Layout_Qualite_HL.cshtml";
}
@if (ViewBag.role == "Agent Qualité_Diffusion")
{
    ViewBag.Title = "AllCases";

    Layout = "~/Views/Shared/_Layout_Diffusion.cshtml";
}
@if (ViewBag.role == "Agent Qualité_AchatPublic")
{
    Layout = "~/Views/Shared/_Layout_AchatPublic.cshtml";
}
@if (ViewBag.role == "Agent Qualité_PRV")
{
    Layout = "~/Views/Shared/_Layout_PRV.cshtml";
}

@model MVCWEB.Models.DirectoryViewModel

@section test{

    <script type="text/javascript" src="/Content/template/Layout 1/LTR/assets/js/plugins/pickers/daterangepicker.js"></script>
    <div class="form-group">
        <div> <label style="font-size: 18px;">Méthode de recherche spécifique</label></div>
        <div class="row">
            <div class="col-1">
             
                <div class="col-xs-3">
                    <label>Choisir compagne: </label>
                </div>
                <div class="col-xs-3">
                    <label class="control-label col-xs-6">Séléctionner IdHermes</label>
                </div>
                <div class="col-xs-4">
                    <label>Sélectionner au moins un agent: </label>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-1">
              
                <div class="col-xs-3">
                    @Html.DropDownList("typeGenerator", Model.topDirectorieDirectories, "-----select-----", htmlAttributes: new { @class = "bootstrap-select", @id = "typeGenerator", @name = "typeGenerator", style = "data-width: 500px;", selected = "selected" })
                    @Html.ValidationMessageFor(model => model.topDirectorieDirectories, "", new { @class = "text-danger" })
                </div>

                <div class="col-xs-3">
                    @Html.DropDownList("IdHermeses", Model.IdHermeses, "-----select-----", htmlAttributes: new { @class = "bootstrap-select", @id = "IdHermeses", @name = "IdHermeses", style = "data-width: 360px;", selected = "selected" })
                    @Html.ValidationMessageFor(model => model.IdHermeses, "", new { @class = "text-danger" })
                </div>

                <div class="col-xs-4">
                    <div class="form-group">
                        <div class="multi-select-full">
                            @Html.DropDownList("PseudoName", Model.utilisateursPseudonames, htmlAttributes: new { @class = "multiselect-filtering", @id = "PseudoName", @name = "PseudoName", style = "data-width: 360px;", selected = "selected", multiple = "multiple" })
                            @Html.ValidationMessageFor(model => model.utilisateursPseudonames, "", new { @class = "text-danger" })
                        </div>
                    </div>

                </div>
            </div>

            </div>
 <br/>
        <div> <label style="font-size: 18px;">Méthode de recherche générale</label></div>
        <div class="row">
            <div class="col-1">
                <div class="col-xs-3">
            <label >Numéro de télephone / Id Hérmes / Nom Compagne</label>
        </div>
                <div class="col-xs-4">
                    <input type="text" required class="form-control" id="tel" placeholder="Entrer IdHermes/Num Tél/NumFiche" />
                </div>  
            </div>
        </div>
    <br/>
<div class="row">
    <div class="col-1">
        <div class="col-xs-4">
            <label style="font-size: 18px;">Bornage Dates (Obligatoire): </label>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-1">   
        <div class="col-xs-8">

            <div class="form-group">
                <div class="input-group">
                    <span class="input-group-addon"><i class="icon-calendar22"></i></span>
                    <input type="text" class="form-control daterange-basic" name="datetimes" id="datetimes" value="01/01/2020 - 01/31/2020">
                </div>
            </div>
        </div>
        <div class="col-1">
            <div class="col-xs-4">
@if (Model.roleKey == "V4")
{
    <button id="imedSave" type="submit" class="btn bg-teal-400" data-title="Chercher Enregistrement" value="Chercher Enregistrement" data-toggle="modal">Recherche <i class="icon-play3 position-right"></i></button>
}
else
{
    <button id="imedSaveV5" type="submit" class="btn bg-teal-400" data-title="Chercher Enregistrement" value="Chercher Enregistrement" data-toggle="modal">Recherche <i class="icon-play3 position-right"></i></button>
}                   </div>
        </div>
    </div>

</div>
   

    <div>
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.roleName, new { @Id = "roleName" })
        @Html.HiddenFor(model => model.roleKey, new { @Id = "roleKey" })
    </div>


    @*<div class="panel panel-flat">
            <div class="panel-heading">
                <h6 class="panel-title">Choix Multiple</h6>
                <div class="heading-elements">

                    <button id="calendar2" type="button" class="btn btn-link daterange-ranges heading-btn text-semibold">
                        <i class="icon-calendar3 position-left"></i> <span></span> <b class="caret"></b>
                    </button>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table table-xlg text-blue">
                    <tbody>
                        <tr>
                            <td class="col-1">

                                    <div class="col-xs-4">

                                        @Html.DropDownList("typeGenerator", Model.topDirectorieDirectories, htmlAttributes: new { @class = "bootstrap-select", @id = "typeGenerator", @name = "typeGenerator", style = "data-width: 360px;", selected = "selected" })
                                        @Html.ValidationMessageFor(model => model.topDirectorieDirectories, "", new { @class = "text-danger" })
                                    </div>

                            </td>
                            <td class="col-md-4">
                                <div class="col-xs-4 date">
                                    <div class="input-group input-append date" style="width:260px">
                                        <input type="text" class="form-control" name="date" id="datePicker" />
                                        <span class="input-group-addon add-on"><span class="glyphicon glyphicon-calendar"></span></span>
                                    </div>
                                </div>
                            </td>
                            <td class="col-md-3">

                                <div class="col-xs-4">
                                    @Html.DropDownList("PseudoName", Model.utilisateursPseudonames, htmlAttributes: new { @class = "bootstrap-select", @id = "PseudoName", @name = "PseudoName", style = "data-width: 360px;", selected = "selected" })
                                    @Html.ValidationMessageFor(model => model.utilisateursPseudonames, "", new { @class = "text-danger" })

                                </div>
                            </td>
                            <td class="col-md-3">
                                <div class="col-xs-4">
                                    @Html.DropDownList("IDHERMESES", Model.IdHermeses, htmlAttributes: new { @class = "bootstrap-select", @id = "IDHERMESES", @name = "IDHERMESES", style = "data-width: 360px;", selected = "selected" })
                                    @Html.ValidationMessageFor(model => model.IdHermeses, "", new { @class = "text-danger" })

                                </div>
                            </td>


                        </tr>

                        @*<tr>
                            <td class="text-right col-md-2">
                                <button id="imedSave" type="submit" class="btn bg-teal-400" data-title="Chercher Enregistrement" value="Chercher Enregistrement" data-toggle="modal">ReCherche <i class="icon-arrow-right14 position-fixed"></i></button>
                            </td>
                        </tr>
                    </tbody>
                </table>

            </div>
        </div>
        <br />*@

    @*<button id="imedSave" type="submit" class="btn bg-teal-400" data-title="Chercher Enregistrement" value="Chercher Enregistrement" data-toggle="modal">ReCherche <i class="icon-arrow-right14 position-fixed"></i></button>*@

    @*<script type="text/javascript">
        </div>
                          $(document).ready ( function () {
                              $(document).on("click", "#imedSave", function () {
                                  var utilisateurs = $("#typeGenerator").val();

                                  var test = $("#test").val();


                              $.ajax({
                                  url: '/Directory/Find',
                                  type: "GET",
                                  contentType: "application/json; charset=utf-8",
                                  traditional: true,
                                  data: {"value":test,"utilisateurs": utilisateurs },
                                  datatype: "html",
                                  async: true,
                                  //success: function(data) {
                                  //    $('#explorer1').html(data);
                                  //    $('#modifier').modal('show');
                                  //  },



                              });


                              })
                          })


                </script>*@
    <br />
    @*<div id="modal_theme_info" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header bg-info">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h6 class="modal-title">Info header</h6>
                    </div>
                    <div class="modal-body">
                        <h6 class="text-semibold">Text in a modal</h6>
                        <p>Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem. Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Vivamus sagittis lacus vel augue laoreet rutrum faucibus dolor auctor.</p>
                        <hr>
                        <h6 class="text-semibold">Another paragraph</h6>
                        <p>Cras mattis consectetur purus sit amet fermentum. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Morbi leo risus, porta ac consectetur ac, vestibulum at eros.</p>
                        <p>Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Vivamus sagittis lacus vel augue laoreet rutrum faucibus dolor auctor.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-link" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>*@
    <div id="explore1">
    </div>
        <div class="row">
            <div class="col-lg-3 col-sm-6">
            </div>

            <div class="col-lg-3 col-sm-6">
                <img id="loadimage" src="~/Content/Loading-GIF-Image-3.gif" style="display: none; align-content:center" />

            </div>
            <div class="col-lg-3 col-sm-6">

            </div>
        </div>
    </div>
    
<script>
    var debut;
    var fin;
$(function() {
    $('#datetimes').daterangepicker({

        opens: 'left',
        format: 'DD/MM/YYYY',
        locale: {

            "daysOfWeek": [
      "Dim",
      "Lun",
      "Mar",
      "Mer",
      "Jeu",
      "Ven",
      "Sam"
            ],
            "monthNames": [
                "Jan",
                "Fev",
                "Mar",
                "Avr",
                "Mai",
                "Ju",
                "Jui",
                "Aou",
                "Sep",
                "Oct",
                "Nov",
                "December"
            ],
        },
        lan: 'fr',


    },
     function (start, end, label) {
         debut = start.format('DD/MM/YYYY');
         fin = end.format('DD/MM/YYYY');
     }
    );
});
</script>
    <script type="text/javascript">
        $(document).ready(function () {
            $(document).on("click", "#imedSave", function () {
                $('#explore1').hide();

                $('#loadimage').show();
                var tests = new Array();

                $('#PseudoName option:selected').each(function () {

                    tests.push(new Array($(this).val()));


                });
                $.ajax({
                    url: '/Superviseur/FindAllCases',
                    type: 'GET',
                    contentType: "application/json; charset=utf-8",
                    traditional: true,
                    data: {
                        compagne: $("#typeGenerator").val(),
                        start:debut,
                        end:fin,
                        pseudoNames: tests,
                        recherche: $("#tel").val(),
                        idhermes: $("#IdHermeses").val(),
                        roleName: $("#roleName").val(),
                    },
                    datatype: "html",
                    async: true,
                    success: function (data) {
                        $('#explore1').html(data);
                        $('#errorFile').modal('show');
                        $('#errorFile2').modal('show');
                        $('#errordate').modal('show');

                        //alert("utilisateur"+" "+$("#typeGenerator").val()+" "+""+ $("#datePicker").val())
                    },
                    complete: function () {
                        $('#loadimage').hide();
                        $('#explore1').show();

                    }
                });
            })
            $(document).on("click", "#imedSaveV5", function () {
                $('#explore1').hide();
                $('#loadimage').show();
                var tests = new Array();
                $('#PseudoName option:selected').each(function () {
                    tests.push(new Array($(this).val()));
                });
                $.ajax({
                    url: '/Superviseur/FindAllCasesV5',
                    type: 'GET',
                    contentType: "application/json; charset=utf-8",
                    traditional: true,
                    data: {
                        compagne: $("#typeGenerator").val(),
                        start: debut,
                        end: fin,
                        pseudoNames: tests,
                        recherche: $("#tel").val(),
                        idhermes: $("#IdHermeses").val(),
                        roleName: $("#roleName").val(),
                        roleKey: $("#roleKey").val()
                    },
                    datatype: "html",
                    async: true,
                    success: function (data) {
                        $('#explore1').html(data);
                        $('#errorFile').modal('show');
                        $('#errorFile2').modal('show');
                        $('#errordate').modal('show');
                    },
                    complete: function () {
                        $('#loadimage').hide();
                        $('#explore1').show();

                    }
                });
            })
        })
    </script>
   
    }
@section pagetitle{
    <h4> <span class="text-semibold">Accès aux Enregistrements</span> @Model.roleName  </h4>
}
@section pagetitlebody{
    <li><a href="#"><i class="icon-home2 position-left"></i> Accès aux Enregistrements</a></li>
    <li class="active">Multiple Choix</li>
}
@section testProfile{

    <a class="dropdown-toggle" data-toggle="dropdown">
        <img src=@Model.Url alt="">
        <span>@Model.userName</span>
        <i class="caret"></i>
    </a>
    <ul class="dropdown-menu dropdown-menu-right">

        <li><a href="@Url.Action("logout", "Authentification")"><i class="icon-switch2"></i> Logout</a></li>
    </ul>
}
@section sidebarProfile{

    <a href="#" class="media-left"><img src=@Model.Url class="img-circle img-sm" alt=""></a>
    <div class="media-body">
        <span class="media-heading text-semibold">@Model.userName</span>
        <div class="text-size-mini text-muted">
            <i class="icon-user text-size-small"></i> &nbsp;@Model.pseudoNameEmp
        </div>
    </div>
    <div class="media-right media-middle">

    </div>
}